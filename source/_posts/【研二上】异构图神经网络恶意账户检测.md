---
title: 异构图神经网络恶意账户检测
date: 2021-09-09
category: 图神经网络
---

## 论文阅读

> Liu, Z., Chen, C., Yang, X., Zhou, J., Li, X., & Song, L. (2018). **[Heterogeneous Graph Neural Networks for Malicious Account Detection.](https://sci-hub.se/10.1145/3269206.3272010)** Proceedings of the 27th ACM International Conference on Information and Knowledge Management - CIKM ’18.* doi:10.1145/3269206.3272010

<!-- more -->

### Introduction

实际问题：Gmail、Facebook、Alipay等大型邮件、社交、金融系统中广泛存在用于非法牟利的恶意注册账户，高效、准确的检测方法非常重要。

研究现状：现有的区分恶意账户和正常用户的的检测方法主要基于账户的**攻击特征**(attack characteristics)

1. Rule based methods 基于规则：人工提取特征、正则表达式
2. Graph-based methods 基于图的方法：考虑账户之间的连通性，通过构建账户连通图来分析异常子图
3. Machine learning-based methods 基于机器学习方法：基于图属性提取特征，构建监督学习分类器

现有方法缺陷：模型误判率低，正常账户和可疑账户数据交叉，导致可疑账户被识别的概率低。

***

文章分析了攻击者（恶意账户）的两个主要行为模式：

* Device aggregation **设备聚集**：攻击者的计算机设备和网络资源固定且少量
* Activity aggregation **活动聚集**：恶意账户倾向于在短时间内批量执行特定任务

文章所作贡献：

* 提出了一种新的基于神经网络的图表示方法(GEM)，同时考虑设备和活动聚集行为来识别恶意帐户。首次将GNN方法应用于欺诈检测。
* 该方法被应用在支付宝上，每天可以检测到数万个恶意账户。

### 提出的方法

#### 数据分析

研究了支付宝中真实账户的“设备聚集”和“行为聚集”特性：

* 设备聚集性：如果同一设备上注册或登录了多个账户，则视为可疑账户。计算**设备-账户图**的连通子图的规模度量账户风险度。

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20210902192736235.png" alt="image-20210902192736235" style="zoom:67%;" />

上图展示了支付宝中连续7天的account-device活动图。对于正常账户，动点均匀分散在不同设备，设备之间平行；对于恶意账户，点的强相关性表明特定的设备连接了大量账户。

* 活动聚集性：如果在同一设备上进行**批量**注册或登录，则视为可以用户。使用同一设备不同账户的活动内积衡量账户间的关联性，可以进一步划分连通子图，提高检测准确率。

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20210902194442682.png" alt="image-20210902194442682" style="zoom:67%;" />

上图展示了正常账户注册后登录行为在未来几天均匀分布，而恶意账户只在短时间内产生行为。

#### 连通子图模型

1. 构建账户`i`和设备`j`的图`G(V,E)`，`{(i, j)}`代表账户`i`在设备`j`上有登录行为。若账户`i`和`i'`都在设备`j`上进行登录，则连接边`(i, i')`，最终形成同质图`Ga(Va,Ea)`，图中的连通子图越大，表明设备聚集越明显，恶意账户可能性越大；
2. 为了降低对正常用户的误判，需要减少一些边。计算两个账户之间的关联性（短时间内登录同一设备），如果小于某个超参阈值，则删去边；
3. 按照账户所属子图大小进行评分，子图越大，账户可疑性越高。

==缺陷==：以上模型仅使用了图的方法直观地检测大的连通子图中的恶意账户，但是在较小子图中效果不佳。

接下来考虑使用机器学习的方法，账户间的连接性既取决于子图大小（设备聚合），也取决于边的内积（活动聚合），因此需要学习一个函数`f`从图结构中学习这些特征并预测。

#### 异构图模型

异构图：由多种不同类型的节点和边组成的图。

假设N个由帐户和设备的节点构成的图G，每个设备对应一种类型d∈D，这里的设备可能是IP地址、MAC地址、IMEI、手机型号等，观察一段时间T内账户-设备之间的边的情况（账户活动情况）。以下是一个连通图的例子：

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20210903104837838.png" alt="image-20210903104837838" style="zoom: 80%;" />

其中蓝色节点是正常账户，黄色节点是异常账户，其余是不同类型的设备，红色节点可能是局域网下同一公网IP。

#### 实验

数据集：支付宝新注册账号的一周活动记录

数据处理：使用前6天的数据构建图模型，对第7天注册的账户进行预测

对比方法：

1. 连通子图
2. GBDT+Graph：一种基于机器学习的方法，GBDT全称为Gradient Boosting Decision Tree
3. GBDT+Node2Vec：基于随机游走的节点嵌入方法
4. GCN：经典的图卷积网络方法

#### 小结

从这篇文章学习了如何对一个图应用问题进行理解、分析和建模，重点在于**构建图**和**邻居信息聚合**。在设计图结构时，选取关联性强的特征作为节点信息。

类似问题还有：欺诈检测、虚假评论（网络水军）识别、网络犯罪识别、恶意程序

可能的问题：恶意爬虫（异常流量检测）



## 下周学习

发现一个仓库：https://github.com/safe-graph

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20210906115045592.png" alt="image-20210906115045592" style="zoom: 67%;" />

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20210907104530997.png" alt="image-20210907104530997" style="zoom: 67%;" />

学习课程：[CS224W: Machine Learning with Graphs](http://web.stanford.edu/class/cs224w/)

![image-20210908095423810](https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20210908095423810.png)