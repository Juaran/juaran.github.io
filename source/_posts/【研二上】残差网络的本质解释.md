---
title: 【研二上】残差网络的本质解释
date: 2021-12-22
category: 机器学习
tag: 周报
---



### **残差网络的一种解释**

斯坦福CS224W《图机器学习》课程(2021) by Jure Leskovec - Stacking layers of a GNN，引用论文：

> Veit A, Wilber M J, Belongie S. Residual networks behave like ensembles of relatively shallow networks[J]. Advances in neural information processing systems, 2016, 29: 550-558.

**目的**：缓解GNN在层数加深时的过平滑（梯度消失）问题，增强较浅的图神经网络层的表达能力

**做法**：增加短路连接(Add skip connection/shorcuts in GNNs)

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20211222110454182.png" alt="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20211222110454182.png" style="zoom: 67%;" />

**为什么短路连接有效？**（论文中关于深度残差连接能够缓解梯度消失问题的理论解释）

- 直觉：短路连接将产生**混合模型**（a mixture of models）
- N个短路连接将得到2^N种可能的路径组合
- 每一种连接方式都对应N种模型
- 最终得到浅层网络和深层网络的组合模型

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20211222111444663.png" alt="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20211222111444663.png" style="zoom: 50%;" />

最后作者根据实验基本得出了一个结论，ResNet 并没有解决深层网络情况下的梯度消失问题，**而是通过集成多个子网络的方式回避了这一问题**。ResNet 只是训练了一系列浅层模型，而 ensemble 中的深层模型并没有得到良好的训练，只不过是这部分模型数量少，并没有影响 ResNet 的整体性能。

因此，深度残差网络能缓解梯度消失的根本原因是其能够学习到不同深度、不同层次模型的表达。网络越深，模型组合（集成）方式越多，表达能力越强。我们希望利用集成模型来学习内部威胁中的各种异常行为模式。

### **内部威胁检测问题的本质**

**本质**：识别日志数据中的异常行为模式

**难点**：融合高维异构数据信息，从不同日志域中检测异常行为的特征组合

- 威胁场景示例1：

> 员工因工作满意度下降而被裁员，对公司感到愤怒，将文件上传到Dropbox，计划用于个人利益。

这种情况将会在生成的数据中产生许多可观测的数据：

1. 下岗员工的数据流结束，从日志目录中消失
2. 登录和注销时间证明，由于工作满意度下降，变得不守时（登录域）
3. HTTP日志显示该员工将文档上传到Dropbox（HTTP域、文件域）

- 威胁场景示例2：

> 员工开始浏览求职网站，并在竞争公司谋职。在离开公司之前，他们使用U盘（频率明显高于以前）窃取数据。

关联域：HTTP域、设备域

- 威胁场景示例3：

> 以前未在下班时间使用U盘的用户，在下班时间登录，然后向维基解密上传数据。很快离开组织。

关联域：登录域、设备域、HTTP域

### **残差连接在内部威胁检测上的解释**

- 残差连接用于形成关注不同域特征的网络模型的集成
- 每一种连接方式都表达了某种行为模式，跳过连接忽略了正常行为特征，进而关联异常特征
- 最终模型表达的是各种可能的用户行为模式

<img src="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20211222160809393.png" alt="https://cdn.jsdelivr.net/gh/juaran/juaran.github.io@image/typora/image-20211222160809393.png" style="zoom:67%;" />

例如，f1/f2/f3可能是卷积得到的登录域/设备域/HTTP域的高维特征空间，残差连接删除f2，所得模型能够专注于登录域和HTTP域的异常检测。而原始的前馈网络同时关注三个域的特征，正常域特征会降低整体的异常行为表现。